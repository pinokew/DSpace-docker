# =================================================================
# 1. PROJECT SETTINGS
# =================================================================
COMPOSE_PROJECT_NAME=dspace9
TZ=Europe/Kyiv

# =================================================================
# 2. VERSIONS & IMAGES
# =================================================================
DOCKER_REGISTRY=docker.io
DOCKER_OWNER=dspace

# Versions
DSPACE_VERSION=dspace-9_x
DSPACE_UI_VER=dspace-9_x-dist
DSPACE_REST_VER=dspace-9_x
DSPACE_SOLR_VER=dspace-9_x
POSTGRES_VERSION=15
TRAEFIK_VERSION=v3.6.8
CLOUDFLARE_TUNNEL_VERSION=2026.2.0

# Host ports (на хості)
DSPACE_UI_PORT=8081

# DSpace settings
DSPACE_NAME="LDUBGD Digital Repository"
DSPACE_CONTAINER_NAME=dspace

# Bootstrap admin (для scripts/bootstrap-admin.sh)
# НЕ коміть реальний пароль у репо — лишай приклад
DSPACE_BOOTSTRAP_ADMIN_EMAIL=admin@example.com
DSPACE_BOOTSTRAP_ADMIN_FIRSTNAME=admin
DSPACE_BOOTSTRAP_ADMIN_LASTNAME=admin
DSPACE_BOOTSTRAP_ADMIN_PASSWORD=change_me
DSPACE_BOOTSTRAP_ADMIN_LOCALE=uk

# UI/REST config generation
DSPACE_UI_LOCALHOST=http://dspace-angular:80
DSPACE_REST_NAMESPACE=/server
DSPACE_REST_SSRBASEURL=http://dspace:8080/server

# ---------- internal paths ----------
POSTGRES_PGDATA=/pgdata
DSPACE_DIR=/dspace

# === ШЛЯХИ ДО ДАНИХ (VOLUME PATHS) ===
VOL_POSTGRESQL_PATH=/srv/DSpace-volumes/postgresql_data
VOL_SOLR_PATH=/srv/DSpace-volumes/solr_data
VOL_ASSETSTORE_PATH=/srv/DSpace-volumes/assetstore
VOL_EXPORTS_PATH=/srv/DSpace-volumes/exports
VOL_LOGS_PATH=/srv/DSpace-volumes/logs

# =================================================================
# 4. NETWORK & SECURITY
# =================================================================
# Фіксована підмережа, щоб уникнути конфліктів
DSPACENET_SUBNET=172.23.0.0/16

# =================================================================
# 5. CREDENTIALS (SECRETS)
# =================================================================
POSTGRES_DB=dspace
POSTGRES_USER=dspace
POSTGRES_PASSWORD=change_me

# =================================================================
# 6. INTERNAL CONFIGURATION
# (Налаштування всередині Docker мережі)
# =================================================================
# Внутрішні порти (не змінюй, якщо не знаєш навіщо)
POSTGRES_INTERNAL_PORT=5432
SOLR_INTERNAL_PORT=8983
DSPACE_INTERNAL_PORT=8080

# Java Opts (Оптимізація для контейнера)
DSPACE_JAVA_OPTS="-Xmx2000m -Djava.security.egd=file:/dev/./urandom"

# --- E-MAIL CONFIGURATION (SMTP) ---
# Приклад для Gmail/Google Workspace: smtp.gmail.com
# Приклад для Office365: smtp.office365.com
DSPACE_MAIL_SERVER=smtp.office365.com
DSPACE_MAIL_PORT=587
# Ваш email для розсилки (no-reply)
DSPACE_MAIL_USERNAME=no-reply@example.com
# Пароль програми (App Password), не звичайний пароль!
DSPACE_MAIL_PASSWORD=change_me
DSPACE_MAIL_ADMIN=support@example.com
DSPACE_MAIL_FEEDBACK=support@example.com

DSPACE_HOSTNAME=repo.example.com
DSPACE_UI_BASEURL=https://repo.example.com
DSPACE_REST_BASEURL=https://repo.example.com/server

PUBLIC_SSL=true

TUNNEL_TOKEN=change_me

# =================================================================
# 10. NGROK
# =================================================================
# DSPACE_UI_BASEURL=https://your-ngrok-domain.ngrok-free.dev
# DSPACE_REST_BASEURL=https://your-ngrok-domain.ngrok-free.dev/server
# DSPACE_UI_SSL=false
# PUBLIC_SSL=true
# NGROK_AUTHTOKEN=change_me

# --- BACKUP CONFIGURATION ---
# Назва налаштування в rclone (те, що ти створив через rclone config)
BACKUP_RCLONE_REMOTE=your-rclone-remote

# Папка на Google Drive, куди складати бекапи
BACKUP_RCLONE_FOLDER=DSpace_Backups

# Папка на сервері, де тимчасово створювати архіви
BACKUP_LOCAL_DIR=../backups

# Скільки днів зберігати локальні повні архіви
BACKUP_RETENTION_DAYS=3

# Назва сервісу БД у docker-compose (зазвичай dspacedb)
DB_SERVICE_NAME=dspacedb

# --- OIDC SETTINGS (Microsoft Entra ID) ---
OIDC_CLIENT_ID=change_me
OIDC_CLIENT_SECRET=change_me
OIDC_AUTHORIZE_ENDPOINT=https://login.microsoftonline.com/<tenant-id>/oauth2/v2.0/authorize
OIDC_TOKEN_ENDPOINT=https://login.microsoftonline.com/<tenant-id>/oauth2/v2.0/token
OIDC_USER_INFO_ENDPOINT=https://graph.microsoft.com/oidc/userinfo
OIDC_ISSUER=https://login.microsoftonline.com/<tenant-id>/v2.0
OIDC_REDIRECT_URL=https://repo.example.com/server/api/authn/oidc
OIDC_DOMAIN=example.edu.ua
OIDC_SCOPES=openid,email,profile
OIDC_CAN_SELF_REGISTER=true
OIDC_EMAIL_ATTR=email
# UUID групи "LDUBGD_users" (Користувачі ЛДУБЖД)
OIDC_LOGIN_GROUP_UUID=00000000-0000-0000-0000-000000000000

# --- AUTH & SECURITY POLICIES ---
# Дозволені методи (включно з PATCH для прийняття угод)
CORS_ALLOWED_METHODS=GET, POST, PUT, DELETE, PATCH, OPTIONS, HEAD
# Порядок аутентифікації
AUTH_METHODS=org.dspace.authenticate.OidcAuthentication, org.dspace.authenticate.PasswordAuthentication
# Логіка доступу до файлів (logged = редірект на логін)
REQUEST_ITEM_TYPE=logged
REQUEST_ITEM_HELPDESK_OVERRIDE=false

# --- UPLOAD LIMITS ---
MAX_FILE_SIZE=2048MB
MAX_REQUEST_SIZE=2048MB

# --- GOOGLE ANALYTICS 4 ---
# ID потоку (Measurement ID)
DSPACE_GA_ID=G-XXXXXXXXXX
# Секретний ключ для Measurement Protocol (щоб рахувати скачування файлів)
DSPACE_GA_API_SECRET=change_me

# --- TRAEFIK DASHBOARD CONFIG ---
TRAEFIK_DASHBOARD_HOST=traefik.example.com
TRAEFIK_DASHBOARD_ALLOWLIST=127.0.0.1/32,172.23.0.0/16

# Генеруй хеш пароля для Traefik Dashboard за допомогою команди нижче і вставляй сюди (замінивши admin: на свій логін і NEW_STRONG_PASSWORD на свій пароль):
# docker run --rm httpd:2.4-alpine htpasswd -nbB admin 'NEW_STRONG_PASSWORD' | sed -e 's/\$/$$/g'
TRAEFIK_DASHBOARD_USERS=admin:$$2y$$replace_with_bcrypt_hash
TRAEFIK_DASHBOARD_PASSWORD=change_me
